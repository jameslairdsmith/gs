<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Work with recurring calendar events in R • gs</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Work with recurring calendar events in R">
<meta property="og:description" content="">
<meta property="og:image" content="https://jameslairdsmith.github.io/gs/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gs</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
     Home
  </a>
</li>
<li>
  <a href="../articles/intro.html">Intro</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/understanding-schedule-limits.html">Understanding schedule limits</a>
    </li>
    <li>
      <a href="../articles/understanding-period-limits.html">Understanding period limits</a>
    </li>
    <li>
      <a href="../articles/holiday-examples.html">Holiday examples</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jameslairdsmith/gs">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Work with recurring calendar events in R</h1>
                        <h4 class="author">James Laird-Smith</h4>
            
            <h4 class="date">2019-09-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jameslairdsmith/gs/blob/master/vignettes/intro.Rmd"><code>vignettes/intro.Rmd</code></a></small>
      <div class="hidden name"><code>intro.Rmd</code></div>

    </div>

    
    
<p>Recurring calendar events are very common in everyday life. When a set of these events recur in a pattern, we call it a ‘schedule’. While some schedules are simple, others can be difficult to work with. This is especially true when the pattern of events is irregular. The objective of <code>gs</code> is to provide a framework to make working with schedules simpler.</p>
<p>To start with, we will import <code>gs</code> along with the <code>magrittr</code> package, which will be useful later on.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(gs)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(magrittr)</a></code></pre></div>
<p><code>gs</code> builds atop the <code>lubridate</code> package and is designed for use alongside it. For this reason, it is imported automatically when <code>gs</code> is imported. When a <code>lubridate</code> function is used in this vignette, I will prefix it with <code>lubridate::</code> to make it clear where the function comes from. Users do not need to include the package name when writing their own code.</p>
<div id="creating-a-schedule" class="section level1">
<h1 class="hasAnchor">
<a href="#creating-a-schedule" class="anchor"></a>Creating a schedule</h1>
<p>In this section we will create a schedule of events occurring every year on New Year’s Day (January 1st). This simple example which teach you the basics of schedules so that you can build-up to more involved examples later on.</p>
<p>Ask yourself, what is unique about New Year’s Day (from a calendar perspective)? It occurs on the first day of the month, but so do many other days. It occurs in January, but so do many other days. You would be right to say that New Year’s Day always occurs on the first day of the year. It is the only day that does so.</p>
<p><code>gs</code> provides a function to create schedules where the events occur only on certain days of the year. The function is called <code><a href="../reference/on_mday.html">on_yday()</a></code> and it accepts numeric input depending on which day of the year you wish to schedule events for. For example, <code><a href="../reference/on_mday.html">on_yday(2)</a></code> would create a schedule of events occurring on the second day of every year. But in our case we want to create a schedule of events occurring on only the first day of every year. So we do so as follows.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="../reference/on_mday.html">on_yday</a></span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; A schedule of events containing 1 term(s)</span></a></code></pre></div>
<p>You may be familiar with the <code>yday()</code> function from the <code>lubridate</code> package. <code>lubridate</code> provides a set of accessor functions for getting the various properties from a date or date-time object. The <code>yday()</code> function returns whatever day of the year a date or datetime occurs on. For example:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">lubridate<span class="op">::</span><span class="kw"><a href="http://lubridate.tidyverse.org/reference/day.html">yday</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(<span class="st">"2000-01-01"</span>))</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt; [1] 1</span></a></code></pre></div>
<p>The equivalent function in <code>gs</code> is <code><a href="../reference/on_mday.html">on_yday()</a></code> and it does the opposite. Instead of the you providing a date and getting back the property of that date, rather you give it the property you want and it will return a schedule of events with that particular property. So by computing <code><a href="../reference/on_mday.html">on_yday(1)</a></code> above, I created a schedule of all the days occurring on the first day of the year.</p>
<p>By itself, this isn’t that useful. What will help make it more so is that we can make this schedule into an object like so:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">on_new_years_day &lt;-<span class="st"> </span><span class="kw"><a href="../reference/on_mday.html">on_yday</a></span>(<span class="dv">1</span>)</a></code></pre></div>
<p>We now have the <code>on_new_years_day</code> schedule object that we can put to use. You can think of this schedule as encompassing all the possible occurrences of New Year’s Day throughout time. It is not limited to just one particular date or dates.</p>
</div>
<div id="using-schedules" class="section level1">
<h1 class="hasAnchor">
<a href="#using-schedules" class="anchor"></a>Using schedules</h1>
<p>Now that we have a schedule object, we can begin using it.</p>
<div id="testing-for-events" class="section level2">
<h2 class="hasAnchor">
<a href="#testing-for-events" class="anchor"></a>Testing for events</h2>
<p>The first thing we can use schedules for is to find out whether certain dates fall on them or not. Lets create an arbitrary set of dates using base R and call them <code>my_dates</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">my_dates &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq.Date">seq.Date</a></span>(<span class="dt">from =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(<span class="st">"2001-01-01"</span>),</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">                     <span class="dt">to =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(<span class="st">"2001-01-10"</span>),</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">                     <span class="dt">by =</span> <span class="st">"1 day"</span>)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">my_dates</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt;  [1] "2001-01-01" "2001-01-02" "2001-01-03" "2001-01-04" "2001-01-05"</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt;  [6] "2001-01-06" "2001-01-07" "2001-01-08" "2001-01-09" "2001-01-10"</span></a></code></pre></div>
<p>We can then use the <code><a href="../reference/happen.html">happen()</a></code> function provided by <code>gs</code> to find out which of these dates falls on New Year’s Day. <code><a href="../reference/happen.html">happen()</a></code> takes a schedule object as its first argument and a date or vector of dates as the second argument. The idea is that the syntax is readable. We are asking for the events which ‘happen’, ‘on New Year’s day’ from ‘<code>my_dates</code>’:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="../reference/happen.html">happen</a></span>(on_new_years_day, my_dates)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt;  [1]  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span></a></code></pre></div>
<p>We can see from this that only the first of our dates fall on New Year’s Day. In this example you can validate this simply by inspecting the dates.</p>
<p>Note that you do not have to make the <code>on_new_years_day</code> schedule into an object if you don’t want to. We could have achieved the same result as follows:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="../reference/happen.html">happen</a></span>(<span class="kw"><a href="../reference/on_mday.html">on_yday</a></span>(<span class="dv">1</span>), my_dates)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#&gt;  [1]  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span></a></code></pre></div>
<p>But, for reasons that will become clear, it is much more useful to create schedules objects. Whenever you do so, I also recommend giving them a descriptive name and starting them with the prefix ‘on_’ or ‘in_’. Among other things, this will make the syntax natural and readable.</p>
</div>
<div id="getting-events" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-events" class="anchor"></a>Getting events</h2>
<p>The next useful thing we can do with a schedule object is get the events from it. This is done using the <code><a href="../reference/schedule.html">schedule_days()</a></code> function, which accepts a schedule as its first argument.</p>
<p>One snag with doing this however is that the total number of New Year’s Days is theoretically infinite. So if we try and run <code><a href="../reference/schedule.html">schedule_days(on_new_years_day)</a></code> we will get an error. What we can do is place date limits on the resulting output using the <code>from</code> and <code>to</code> arguments:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="../reference/schedule.html">schedule_days</a></span>(on_new_years_day, </a>
<a class="sourceLine" id="cb8-2" data-line-number="2">              <span class="dt">from =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(<span class="st">"2001-01-01"</span>), </a>
<a class="sourceLine" id="cb8-3" data-line-number="3">              <span class="dt">to =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(<span class="st">"2001-01-10"</span>))</a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt; [1] "2001-01-01"</span></a></code></pre></div>
<p>This gives us all the occurrences of New Year’s Day within the boundaries we have specified. Let’s expand these boundaries so we get more occurrences of New Year’s Day. Here I extend the boundaries from the start of 1995 to the end of 2005.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="../reference/schedule.html">schedule_days</a></span>(on_new_years_day, </a>
<a class="sourceLine" id="cb9-2" data-line-number="2">              <span class="dt">from =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(<span class="st">"1995-01-01"</span>), </a>
<a class="sourceLine" id="cb9-3" data-line-number="3">              <span class="dt">to =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(<span class="st">"2005-12-31"</span>))</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt;  [1] "1995-01-01" "1996-01-01" "1997-01-01" "1998-01-01" "1999-01-01"</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt;  [6] "2000-01-01" "2001-01-01" "2002-01-01" "2003-01-01" "2004-01-01"</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt; [11] "2005-01-01"</span></a></code></pre></div>
<p>Because this is a little cumbersome to type, <code><a href="../reference/schedule.html">schedule_days()</a></code> allows you to abbreviate <code>to</code> and <code>from</code> to only the numeric years you wish to use as boundaries. These go from the start of the <code>from</code> year to the end of the <code>to</code> year. That means this code is equivalent to what we just ran:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="../reference/schedule.html">schedule_days</a></span>(on_new_years_day, <span class="dt">from =</span> <span class="dv">1995</span>, <span class="dt">to =</span> <span class="dv">2005</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt;  [1] "1995-01-01" "1996-01-01" "1997-01-01" "1998-01-01" "1999-01-01"</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt;  [6] "2000-01-01" "2001-01-01" "2002-01-01" "2003-01-01" "2004-01-01"</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt; [11] "2005-01-01"</span></a></code></pre></div>
<p>If the events we want only occur in a single year, we can use the <code>during</code> argument as a further numeric shortcut, which is the equivalent of setting <code>to</code> and <code>from</code> to the start and end of one particular year:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="../reference/schedule.html">schedule_days</a></span>(on_new_years_day, <span class="dt">during =</span> <span class="dv">2005</span>)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">#&gt; [1] "2005-01-01"</span></a></code></pre></div>
</div>
</div>
<div id="further-basic-schedules" class="section level1">
<h1 class="hasAnchor">
<a href="#further-basic-schedules" class="anchor"></a>Further basic schedules</h1>
<p>The <code><a href="../reference/on_mday.html">on_yday()</a></code> function isn’t the only type of schedule that you can create. <code>gs</code> provides a whole host of functions to create schedules. These all follow from the syntax of the accessor functions found in <code>lubridate</code>. In each case the same function text name is prefixed by either <code>on_</code> or <code>in_</code> depending on how one would naturally say it.</p>
<p>For example, the <code><a href="../reference/on_mday.html">on_mday()</a></code> function creates a schedule of events occurring on the specified days of every month. Imagine your job pays your salary on the 25th of each month; if you wanted to create a schedule of your paydays you would do so as follows:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">on_payday &lt;-<span class="st"> </span><span class="kw"><a href="../reference/on_mday.html">on_mday</a></span>(<span class="dv">25</span>)</a></code></pre></div>
<p>If instead you get paid weekly every Friday, you can use the <code><a href="../reference/on_mday.html">on_wday()</a></code> function which accepts either a day number (where 1 is Sunday by default), a day name or a day abbreviation as the first argument. This means each of these are equivalent and create the schedule of your weekly paydays:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">on_weekly_payday &lt;-<span class="st"> </span><span class="kw"><a href="../reference/on_mday.html">on_wday</a></span>(<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">on_weekly_payday &lt;-<span class="st"> </span><span class="kw"><a href="../reference/on_mday.html">on_wday</a></span>(<span class="st">"Friday"</span>)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">on_weekly_payday &lt;-<span class="st"> </span><span class="kw"><a href="../reference/on_mday.html">on_wday</a></span>(<span class="st">"Fri"</span>)</a></code></pre></div>
<p>I won’t go over all the available functions here. You can see them for yourself in the package reference documentation. They all follow the same principle of generating schedules from the inputs you provide to them. Some will also appear in the upcoming examples.</p>
<p>Each of the functions will accept multiple inputs which in each case creates a schedule of events occurring on both the inputs. For example <code><a href="../reference/on_mday.html">on_wday("Mon", "Wed", "Fri")</a></code> creates a schedule of events occurring on all of those days of the week. For convenience the <code><a href="../reference/on_mday.html">on_weekday()</a></code> and <code><a href="../reference/on_mday.html">on_weekend()</a></code> functions are also provided in the package without you having to create them.</p>
</div>
<div id="combining-schedules" class="section level1">
<h1 class="hasAnchor">
<a href="#combining-schedules" class="anchor"></a>Combining schedules</h1>
<p>By itself, New Year’s Day isn’t that interesting (from a calendar perspective). We could have achieved the same thing using base R. The power of <code>gs</code> comes when dealing with more intricate schedules. For this, we need something more. <code>gs</code> allows you to compose more complex schedules by combining basic ones.</p>
<div id="intersecting-schedules" class="section level2">
<h2 class="hasAnchor">
<a href="#intersecting-schedules" class="anchor"></a>Intersecting schedules</h2>
<p>Say that, instead of New Year’s Day, we were interested in Christmas day. Ask yourself, what is uniquely special about Christmas day (from a calendar perspective)? You may think of using <code><a href="../reference/on_mday.html">on_yday()</a></code> again and say that Christmas occurs on the 359th day of the year and so create the schedule <code><a href="../reference/on_mday.html">on_yday(359)</a></code>. But this wouldn’t work because in a leap year Christmas day is the 360th day of the year. The only way to create a schedule of events on Christmas is to schedule them on December 25th.</p>
<p><code>gs</code> provides some functions to help us along the way. We have the <code><a href="../reference/in_month.html">in_month()</a></code> function which creates a schedule of events in a given month. We could use that, but <code><a href="../reference/in_month.html">in_month(12)</a></code> would give us all the events in December and we are only interested in the 25th one. We could also use the <code><a href="../reference/on_mday.html">on_mday()</a></code> function. But <code><a href="../reference/on_mday.html">on_mday(25)</a></code> is going to give us a schedule of events occurring on the 25th of every month, not just December.</p>
<p>What we need is the <strong>intersection</strong> of these two schedules. For this purpose <code>gs</code> provides the <code><a href="../reference/also_occur.html">only_occur()</a></code> function, which accepts two schedules and returns a single schedule which is the intersection of the two inputs.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">on_christmas_day &lt;-<span class="st"> </span><span class="kw"><a href="../reference/also_occur.html">only_occur</a></span>(<span class="kw"><a href="../reference/on_mday.html">on_mday</a></span>(<span class="dv">25</span>), <span class="kw"><a href="../reference/in_month.html">in_month</a></span>(<span class="dv">12</span>))</a></code></pre></div>
<p>Again the syntax is designed to be readable. We are creating a schedule called <code>on_christmas_day</code> which ‘only occur’ on 25th day of the month and ‘only occur’ in the twelfth month of the year.</p>
<p>Now that we have this new <code>on_christmas_day</code> object, we can do with it the same set of things we did with the <code>on_new_years_day</code> object. We can test if certain dates fall upon it with the <code><a href="../reference/happen.html">happen()</a></code> function. Or we can get the events from it using the <code><a href="../reference/schedule.html">schedule_days()</a></code> function:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="../reference/schedule.html">schedule_days</a></span>(on_christmas_day, <span class="dt">from =</span> <span class="dv">2000</span>, <span class="dt">to =</span> <span class="dv">2004</span>)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="co">#&gt; [1] "2000-12-25" "2001-12-25" "2002-12-25" "2003-12-25" "2004-12-25"</span></a></code></pre></div>
<p>If I wanted to create a schedule of Boxing Day days, the process is the same. Boxing day occurs on Dec 26th.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">on_boxing_day &lt;-<span class="st"> </span><span class="kw"><a href="../reference/also_occur.html">only_occur</a></span>(<span class="kw"><a href="../reference/on_mday.html">on_mday</a></span>(<span class="dv">26</span>), <span class="kw"><a href="../reference/in_month.html">in_month</a></span>(<span class="dv">12</span>))</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="kw"><a href="../reference/schedule.html">schedule_days</a></span>(on_boxing_day, <span class="dt">from =</span> <span class="dv">2000</span>, <span class="dt">to =</span> <span class="dv">2004</span>)</a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="co">#&gt; [1] "2000-12-26" "2001-12-26" "2002-12-26" "2003-12-26" "2004-12-26"</span></a></code></pre></div>
</div>
<div id="uniting-schedules" class="section level2">
<h2 class="hasAnchor">
<a href="#uniting-schedules" class="anchor"></a>Uniting schedules</h2>
<p>Sometimes, instead of finding the intersection between schedules, you will instead want to unite schedules. For example, say now that we have the schedules for <code>on_new_years_day</code> and <code>on_christmas</code> we wanted to create a schedule of public holidays. To do this, <code>gs</code> provides the <code><a href="../reference/also_occur.html">also_occur()</a></code> function which takes two schedules as input and returns a single unified schedule as its output.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">on_public_holidays &lt;-<span class="st"> </span><span class="kw"><a href="../reference/also_occur.html">also_occur</a></span>(on_christmas_day, on_new_years_day)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"></a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="kw"><a href="../reference/schedule.html">schedule_days</a></span>(on_public_holidays, <span class="dt">from =</span> <span class="dv">2000</span>, <span class="dt">to =</span> <span class="dv">2004</span>)</a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="co">#&gt;  [1] "2000-01-01" "2000-12-25" "2001-01-01" "2001-12-25" "2002-01-01"</span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="co">#&gt;  [6] "2002-12-25" "2003-01-01" "2003-12-25" "2004-01-01" "2004-12-25"</span></a></code></pre></div>
<p>We now have a new schedule of public holidays available for us to use further.</p>
<p>One other thing to take note of is that the schedules we made use of in this step were themselves generated in earlier steps. This can be done an arbitrary number of times and allows huge flexibility when creating your own schedules.</p>
<p>The syntax of the <code><a href="../reference/also_occur.html">also_occur()</a></code> and <code><a href="../reference/also_occur.html">only_occur()</a></code> functions also lend themselves to piping (<code>%&gt;%</code>) using the <code>magrittr</code> package. For example, if I wanted to include Boxing Days in my public holiday schedule I could re-make it as follows:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">on_public_holidays &lt;-</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="st">  </span>on_christmas_day <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/also_occur.html">also_occur</a></span>(on_new_years_day) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="../reference/also_occur.html">also_occur</a></span>(on_boxing_day)</a>
<a class="sourceLine" id="cb18-5" data-line-number="5"></a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="kw"><a href="../reference/schedule.html">schedule_days</a></span>(on_public_holidays, <span class="dt">from =</span> <span class="dv">2000</span>, <span class="dt">to =</span> <span class="dv">2004</span>)</a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="co">#&gt;  [1] "2000-01-01" "2000-12-25" "2000-12-26" "2001-01-01" "2001-12-25"</span></a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="co">#&gt;  [6] "2001-12-26" "2002-01-01" "2002-12-25" "2002-12-26" "2003-01-01"</span></a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="co">#&gt; [11] "2003-12-25" "2003-12-26" "2004-01-01" "2004-12-25" "2004-12-26"</span></a></code></pre></div>
<p>Again the syntax is readable. We are creating a public holidays schedule, where the events occur on Christmas day, and ‘also occur’ on New Year’s Day and ‘also occur’ on Boxing Day.</p>
</div>
<div id="inverting-schedules" class="section level2">
<h2 class="hasAnchor">
<a href="#inverting-schedules" class="anchor"></a>Inverting schedules</h2>
<p>Once you have a schedule it is often useful to have way to invert it so as to get the events that do not occur on that schedule. This can be done using the <code><a href="../reference/doesnt_occur.html">doesnt_occur()</a></code> function. For example, say that instead of focusing on holidays, you instead wanted to get a schedule of working (or business) days. These are the days that occur on neither weekends nor on public holidays. You could get that schedule of events as follows. First you would create the schedule of non-working days as follows:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">on_non_working_days &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/on_mday.html">on_weekend</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/also_occur.html">also_occur</a></span>(on_public_holidays)</a></code></pre></div>
<p>And then invert it using <code><a href="../reference/doesnt_occur.html">doesnt_occur()</a></code>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">on_business_days &lt;-<span class="st"> </span><span class="kw"><a href="../reference/doesnt_occur.html">doesnt_occur</a></span>(on_non_working_days)</a></code></pre></div>
<p>You then have a new schedule of business days to work with that can be used in exactly the same ways already shown.</p>
</div>
</div>
<div id="nth-occurrences-within-periods" class="section level1">
<h1 class="hasAnchor">
<a href="#nth-occurrences-within-periods" class="anchor"></a>Nth occurrences within periods</h1>
<p>One of the most common schedule patterns are when events take place on the nth occurrence of another schedule within a given period. For example, in the United States, Martin Luther King Jr. Day is celebrated on the third Monday in January.</p>
<p>This date rule has a few components. ‘Monday’, ‘January’ and ‘third occurrence within a given month’. Mondays don’t have their own schedule, but instead are created by <code><a href="../reference/on_mday.html">on_wday("Mon")</a></code>. January also doesn’t have it’s own schedule, but is instead created using <code><a href="../reference/in_month.html">in_month("Jan")</a></code>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">in_jan &lt;-<span class="st"> </span><span class="kw"><a href="../reference/in_month.html">in_month</a></span>(<span class="st">"Jan"</span>)</a>
<a class="sourceLine" id="cb21-2" data-line-number="2">on_monday &lt;-<span class="st"> </span><span class="kw"><a href="../reference/on_mday.html">on_wday</a></span>(<span class="st">"Mon"</span>)</a></code></pre></div>
<p>To find the third occurrence of a scheduled event within a period <code>gs</code> provides the <code><a href="../reference/on_nth.html">on_third()</a></code> function, which accepts a schedule as its first argument and a period type string as its second argument (called <code>within_given =</code>). So the schedule of every third Monday of the month is created as follows:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">on_third_monday_month &lt;-<span class="st"> </span><span class="kw"><a href="../reference/on_nth.html">on_third</a></span>(on_monday, <span class="dt">within_given =</span> <span class="st">"month"</span>)</a></code></pre></div>
<p>But because Martin Luther King Jr. Day doesn’t occur every month, it only occurs in January, we have to refine our schedule one step further:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">on_mlk_jr_day &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="st">  </span>on_third_monday_month <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/also_occur.html">only_occur</a></span>(in_jan)</a></code></pre></div>
<p>We now have our schedule can can call on it for our purposes as before:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw"><a href="../reference/schedule.html">schedule_days</a></span>(on_mlk_jr_day, <span class="dt">from =</span> <span class="dv">2010</span>, <span class="dt">to =</span> <span class="dv">2020</span>)</a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="co">#&gt;  [1] "2010-01-18" "2011-01-17" "2012-01-16" "2013-01-21" "2014-01-20"</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="co">#&gt;  [6] "2015-01-19" "2016-01-18" "2017-01-16" "2018-01-15" "2019-01-21"</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="co">#&gt; [11] "2020-01-20"</span></a></code></pre></div>
<p><code><a href="../reference/on_nth.html">on_third()</a></code> isn’t the only function provided for this purpose. There is also <code><a href="../reference/on_nth.html">on_first()</a></code>, <code><a href="../reference/on_nth.html">on_second()</a></code>, <code><a href="../reference/on_nth.html">on_fourth()</a></code> and <code><a href="../reference/on_nth.html">on_last()</a></code>. These are all convenience functions of <code><a href="../reference/on_nth.html">on_nth()</a></code> which instead accepts an integer as its first argument. Positive integers encode the nth occurring event within the period; negative integers encode the nth last occurring events of the period.</p>
<p>As a somewhat bizarre example, say that you play for a football team whose matches are on the 12th either Monday, Wednesday or Friday of every quarter. You could find your match days as follows:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">on_monday_wednesday_friday &lt;-<span class="st"> </span><span class="kw"><a href="../reference/on_mday.html">on_wday</a></span>(<span class="st">"Mon"</span>, <span class="st">"Wed"</span>, <span class="st">"Fri"</span>)</a>
<a class="sourceLine" id="cb25-2" data-line-number="2"></a>
<a class="sourceLine" id="cb25-3" data-line-number="3">on_football_days &lt;-<span class="st"> </span><span class="kw"><a href="../reference/on_nth.html">on_nth</a></span>(<span class="dv">12</span>, </a>
<a class="sourceLine" id="cb25-4" data-line-number="4">                           on_monday_wednesday_friday, </a>
<a class="sourceLine" id="cb25-5" data-line-number="5">                           <span class="dt">within_given =</span> <span class="st">"quarter"</span>)</a>
<a class="sourceLine" id="cb25-6" data-line-number="6"></a>
<a class="sourceLine" id="cb25-7" data-line-number="7"><span class="kw"><a href="../reference/schedule.html">schedule_days</a></span>(on_football_days, <span class="dt">from =</span> <span class="dv">2019</span>, <span class="dt">to =</span> <span class="dv">2020</span>)</a>
<a class="sourceLine" id="cb25-8" data-line-number="8"><span class="co">#&gt; [1] "2019-01-28" "2019-04-26" "2019-07-26" "2019-10-28" "2020-01-27"</span></a>
<a class="sourceLine" id="cb25-9" data-line-number="9"><span class="co">#&gt; [6] "2020-04-27" "2020-07-27" "2020-10-28"</span></a></code></pre></div>
</div>
<div id="conclusion" class="section level1">
<h1 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h1>
<p>This vignette has provided an introduction to the <code>gs</code> package, which implements a grammar of recurring calendar events in R.</p>
<p><code>gs</code> has greater capabilities than just those explained above. The remainder of the package documentation provides greater detail on both the features shown and those I have not had time to mention.</p>
<p>Because <code>gs</code> is a grammar, it provides the building blocks for you as a user to combine the different parts in new and interesting ways and to make your own schedules based on your own needs.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#creating-a-schedule">Creating a schedule</a></li>
      <li>
<a href="#using-schedules">Using schedules</a><ul class="nav nav-pills nav-stacked">
<li><a href="#testing-for-events">Testing for events</a></li>
      <li><a href="#getting-events">Getting events</a></li>
      </ul>
</li>
      <li><a href="#further-basic-schedules">Further basic schedules</a></li>
      <li>
<a href="#combining-schedules">Combining schedules</a><ul class="nav nav-pills nav-stacked">
<li><a href="#intersecting-schedules">Intersecting schedules</a></li>
      <li><a href="#uniting-schedules">Uniting schedules</a></li>
      <li><a href="#inverting-schedules">Inverting schedules</a></li>
      </ul>
</li>
      <li><a href="#nth-occurrences-within-periods">Nth occurrences within periods</a></li>
      <li><a href="#conclusion">Conclusion</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by James Laird-Smith.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
